---
icon: pen-to-square
date: 2023-07-13
category:
  - 杂项
tag:
  - 操作系统
  - NAS
star:
  - 3
---



<!-- more -->网络附属存储（Network Attached Storage, NAS），顾名思义就是连接在网络上、用来存储数据的一种设备，本质上是一台电脑（服务器）。一般来说，任何带有存储功能的电脑都可以作为NAS来使用。大型公司的NAS普遍使用能够7x24小时的服务器作为NAS，而家庭因为不需要7x24小时使用，所以对各种硬件（特别是硬盘）的要求会低一些。我主要是关注家庭NAS，却几乎对它们一无所知，只知道少数几款家用NAS的品牌机，例如群晖、威联通等的一些家用型号。然而，高昂的售价（不包括硬盘就已经几千块了）让我望而却步，不知道从哪里入手。考虑到我的NAS并不需要承担太多任务，只需要能在电视上看4K电影就可以了，既不用来存储照片，也不用来存工作视频（我工作也用不上视频），所以我决定把家里的旧电脑变成一台NAS。



# NAS之路

目前来说这只是一个杂项文章，如果我有资金能支持自己升级NAS的话，或许会变成一整个系列也说不定。当然需要强调的是，NAS并非我的刚需，只是正好家里有一台旧电脑，让它闲着也是闲着，不如加块便宜的二手硬盘(17块钱500G)变成NAS，有时候还可以给家里人放放4K电影。

另外提一句，据说NAS、路由器、软路由这些东西都是中年男人的快乐，难道我已经提前步入中年了吗？笑死。

## 硬件

这些配件都是很旧的型号，但经久耐用。这台电脑是15年装的，到现在也断断续续用了8年了。因为工作强度不高，它各个组件还保持得比较好，就是有点积灰而已。

主板 GA-B85-M-D2V

CPU i5-4460 （TDP 85W）

内存 金士顿8G DDR3

显卡 RX550 2G 单风扇品牌机拆机（这是最近才加上的）

电源 先马 刺客630 额定500W

散热 英特尔盒装CPU赠送

机箱 忘记了

硬盘 128G固态\*1、500G机械\*2



我看其他人的方案都非常不推荐i5-4460这款CPU，主要是因为它的TDP功耗太高。不过，对于不用24小时开机的NAS来说，这倒也无所谓。用来做NAS的CPU，最热门的应该是T结尾的低功耗CPU，比如i3-8100T等等，待机功耗相当低，性能也不差，在做NAS的同时还可以做Minecraft服务器之类的工作。不过我倒是无所谓，有没有都行。毕竟现在也不是玩游戏的时候，我连工作都还没找到。

这台电脑自带一个千兆网卡，但是可能速度会不够，后面我会根据实际情况考虑是不是要在PCIe 3.0 1x接口上再加一块2.5Gb的网卡。



## 存储

对于NAS来说，最重要的当然就是存储。存储需要考虑的东西有很多，特别是放在家里。一些转速高或者盘片多的硬盘可能会有很大的炒豆声，首先要考虑找地方放。不过我现在只有1块128G固态用来当系统盘，1块500G西数蓝盘（机械）和1块500G的东芝机械硬盘，我放在自己的房间里，完全没问题，甚至可以晚上下电影下过夜，也不会吵到我睡觉。



## NAS系统

NAS的专用系统有很多，但很多都是收费的。更有一些系统，它们原则上只供生产商自家的品牌NAS使用，比如群晖系统，一般把真正的群晖NAS中的NAS系统称为白群晖（网上一般叫“白裙”），在其他NAS上安装并破解的群晖系统称为黑群晖（网络上称为“黑裙”）。自组NAS想要选择这些封闭的NAS系统破解安装不是不行，只是风险比较大，而且一般无法更新，每个更新都要等大佬把破解做出来之后才能更新。所以，尽管群晖官方已经声明并不禁止黑群晖，但我还是不可能选黑群晖的。

还有另一种选择就是专门为NAS开发的系统，但却又不封闭于某个品牌之内的NAS系统，比如unRaid。但是，不封闭在某个品牌之内又不意味着不收费，unRaid是会根据电脑中的硬盘数量向用户收费的。正如刚才所说，我还没找到工作，而且接下来花钱的地方还有很多，所以我也否决了这个系统。

在了解了这些系统之后，最终我的选择是，Win NAS。就是把Windows直接作为NAS系统去使用。为什么呢？首先，这台电脑自带Windows 7，不用我再去折腾了。人在身心俱疲的情况下，很难再去做什么实际工作。第二，它是我最熟悉的系统，没有之一。很多花里胡哨的操作都可以在Windows上做到，当然了，只是因为Linux我用的时间短，还不过1坤年（如果不算树莓派的话），不然Linux当然是可玩性更好的那一方。还有一点就是，Windows的生态并不比Linux差多少。NAS该有的功能，也基本都有人实现过了。现在也有不少人开发将Windows作为NAS的必要软件。一般来说，NAS系统会把磁盘阵列当作一整个磁盘去管理，而不是拆成多块，其实Windows也能做到这点。再者，我做这个NAS只是想要在电视上结合KODI看看4K电影而已，根本没必要花时间去搞那么复杂的操作。

综上，我选择了Win NAS。

在既没有闲钱，也没有时间的情况下，我选择了不折腾。

要是我既有闲钱，又有时间，我大概也会选择不折腾——因为可以直接买品牌机，我所需要的功能不需要折腾就能用，省下来的时间还能拿来看电影，多好。



## 何为Raid

Raid的介绍有很多，我真的不想再重复一次了，就放个链接在这里

[RAID磁盘阵列是什么](https://zhuanlan.zhihu.com/p/51170719)



## 自组Win NAS的问题

这个问题前文我说了很多了，就不再说了，反正也没人看，哈哈。

还是总结以下几点吧：

1. 功耗问题

   如果在选硬件的时候不考虑功耗问题的话，功耗可能会比较大。对于24小时开机的电脑来说，低功耗一定是很重要的。目前我手上这台机的待机功耗大概在10-15W这样，其实不算很高。如果贪便宜用至强E3或者E5组NAS的话，一定要注意功耗问题，免得付电费的时候泪流满面（哈哈）。

2. 稳定性问题

   这里还是以需要24小时运行的NAS为例。不是所有硬件设计出来都是能够做到7x24小时运行的。比如西数蓝盘，它的设计工作时长是5x8小时。每周工作5天，每天工作8小时，它的实际寿命才有可能达到它设计的预期寿命。一般来说，企业盘（比如西数金盘）还有监控盘（比如西数紫盘）这些，设计寿命才能达到7x24小时。不过，一般来说，监控盘的转速只有5400转，而企业盘、蓝盘这些都是能达到7200转的，速度稍微快一点。家用的话，实际感知可能不大，至少网上的测评是这样说的。

   还有，网上卖的那些便宜的硬盘要么就是上古卷轴，要么就是矿盘。比如我这块西数蓝盘，它是2014年生产的，这块希捷的硬盘的我也没查是什么时候的。像这种硬盘，随时都有可能挂掉，所以要么就不要往里面存重要的东西，要么就老老实实做好Raid或者冷备份。 

3. 更新问题

   对于我这台电脑来说，更新应该不成问题——因为它是Windows 7，微软不给它更新了，不用担心什么时候关机了又要强制更新，又给我搞出一堆bug。但Windows 10或者11现在都还在更新，还比较频繁，甚至不能直接关掉，官方只提供几个星期的暂停更新。这需要通过一些非常规操作去暂停更新。好家伙，在黑群晖上的问题是更新太慢，到了Windows上又变成更新太快了。



## 共享方案

既然是一台NAS，那一定需要通过一些方式把电脑暴露在网络上，可以是局域网，也可以是公网。我只是拿来看片的，那暴露在局域网里就行了。

### FTP

FTP是一个很方便的协议，能快速向网络暴露自身，也比较安全。访问者既需要知道NAS的IP地址，又需要提供账号密码。还可以通过设置白名单，进一步加强安全性。但既然我只在局域网里用，也就无所谓安全性了。

我用的软件是一个叫HOME FTP SERVER的软件，随便一搜应该就有了。我一时也忘记它的官网在哪里了，也没搜到，可能改名了。因为我看到一个叫Wing FTP Server的软件，也是可以用的。

**Home FTP Server**很容易设置，打开软件后，新增账户，把需要共享的内容放到同一个文件夹下，把这个文件夹选定为账户的主目录，设置好账号密码就行。打开CMD，输入ipconfig看看电脑的IP是多少，在KODI添加源的时候需要用上。





### SMB

SMB也同样很方便，因为Windows就自带这个协议。当然，刚才说的FTP也是有自带的，只是折腾起来可能比较麻烦。SMB其实就是网上邻居，用过XP的人都知道这个词。只要设置好共享文件夹，就可以在网络上访问到共享文件夹了。



以上这两个是我知道的而且用过的协议，他们都有一个问题——速度慢。不过这个锅也不能全由协议来背，毕竟我的硬件条件也不怎么样。我在电视上的KODI中看4K电影的时候还是会卡顿，这显得这台NAS很多余。所以我正在找一些廉价的解决方案。比如，更换更好的网线等等。我用来连设备的网线是很早以前的网线，比我在学校里买的六类线细了一圈。所以我打算先换成六类线试试看卡不卡，再做其他尝试（六类线！八块钱三根！嘿嘿！）。



## 刮削方案

### 什么是刮削器

电影刮削，指的大概是通过影片的名字，筛选信息，然后从网络上搜索电影信息、电影海报等，下载到本地的过程。

电影是有标准命名的，一般来说，只有经过标准化命名的影片才能刮削，但现在有些也不需要，足够智能。为什么需要电影刮削？当然是为了好看啦！比如我后面要提到的KODI播放器，能在电视上显示电影海报墙，点开后还能看到演员的相片、电影的评分、电影的简介等信息，这些对于一个家庭影音系统来说都是至关重要的，不像在电脑上看，直接一点开看就完事了。

氛围感要拉满！



### KODI的刮削器

KODI是个很强大的播放器，它有很多插件，比如自动搜索字幕、自动刮削等。

KODI的自动刮削器，内容来源还是很丰富的，它会根据不同的插件，去选择不同的刮削源。不过，官方的刮削器可能因为GFW，需要改hosts才能用，当然也可能直接能用，我是没有成功过的。



### 外接刮削

这个推荐有很多。外接刮削就是在电脑上先刮削好，然后再由KODI去显示。Jellyfin就是一款很强大的电影刮削器，而且免费。问题是，它也需要改hosts，不过，电脑上改要比路由器里改简单太多了， 所以也能用。



我想提的是一个国产软件，叫做极影派，它就是我提到的，不需要把电影命名标准化也能刮削的软件，而且它在获取完电影信息后，还能用工具把没有标准化命名的电影直接标准化，这点非常方便。



## KODI

### 播放器

KODI是一款设计优秀的集成播放器。说它是集成播放器是因为，它不仅能放视频，还能拿来看电视、听音乐等。外观优秀是它的优点之一，通过插件还能更换更好看的主题。插件丰富是它更重要的优点。正如上面所说，KODI具有自动匹配字幕、自动刮削等插件。最重要的，它是一款开源免费的、跨平台的播放器，带有与其他设备通信的协议接口，可以轻松地添加网络源。这也为我们的NAS提供了方便。我自用的就是NAS+KODI，通过FTP在电视上看电影。

KODI有安卓版、苹果Mac版、安卓电视版和Windows等版本，现在已经更新到20.x的版本号了。不过奇怪的是，我家电视不能运行最新版，只能安装到18.9版，这点比较可惜。安装也很简单，把安装包放U盘里，直接在电视上装就行。它还能看RSS，不过我并不用它作为RSS的阅读器，尽管RSS确实还支持推送视频，但我自己用电视的时间并不多，所以没有考虑。

**设置中文**首先需要到设置界面，找到interface，在General选项中，找到Font，把字体修改成Aral。因为默认字体是不带中文的，如果设置成中文，会变成框框。然后在第二个选项卡中，找到language，改成Chinese(Simple)，就可以了。



### 添加源

**主页电影**选项卡现在是空的，没有海报墙，也没有可以看的电影。需要先添加源。在选项卡这里，浏览文件。



## 流畅度提升

换上新线之后，普通播放确实是不会卡了，连70G的4K电影也不会卡。可是，拖动进度条或者从上次播放到的位置看还是会很卡。这点很不对劲。

### 设置缓存

这个或许解决不了这个问题。

